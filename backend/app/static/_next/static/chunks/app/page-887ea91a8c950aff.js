(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46482:function(e,s,t){Promise.resolve().then(t.bind(t,7293)),Promise.resolve().then(t.t.bind(t,81749,23))},7293:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return V}});var l=t(3827),a=t(15237),n=t(64090);let r=e=>!!e&&"object"==typeof e&&0!==Object.keys(e).length,i=(e,s)=>(s&&e.forEach((e,t)=>{let l=s[t];r(l)&&(e.data=l)}),e);var o=t(76371),c=t(57742),d=t(34734),u=t(51367);function m(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,u.m6)((0,d.W)(s))}let h=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),p=n.forwardRef((e,s)=>{let{className:t,variant:a,size:n,asChild:r=!1,...i}=e,c=r?o.g7:"button";return(0,l.jsx)(c,{className:m(h({variant:a,size:n,className:t})),ref:s,...i})});p.displayName="Button";var f=t(18994),x=t(80223);function g(e){var s;let{config:t,onFileUpload:a,onFileError:r}=e,[i,o]=(0,n.useState)(!1),c=(null==t?void 0:t.inputId)||"fileInput",d=(null==t?void 0:t.fileSizeLimit)||52428800,u=null==t?void 0:t.allowedExtensions,p=null!==(s=null==t?void 0:t.checkExtension)&&void 0!==s?s:e=>u&&!u.includes(e)?"Invalid file type. Please select a file with one of these formats: ".concat(u.join(",")):null,g=e=>e.size>d,v=()=>{document.getElementById(c).value=""},b=async e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];t&&(o(!0),await j(t),v(),o(!1))},j=async e=>{let s=r||window.alert,t=p(e.name.split(".").pop()||"");return t?s(t):g(e)?s("File size exceeded. Limit is ".concat(d/1024/1024," MB")):void await a(e)};return(0,l.jsxs)("div",{className:"self-stretch",children:[(0,l.jsx)("input",{type:"file",id:c,style:{display:"none"},onChange:b,accept:null==u?void 0:u.join(","),disabled:(null==t?void 0:t.disabled)||i}),(0,l.jsx)("label",{htmlFor:c,className:m(h({variant:"secondary",size:"icon"}),"cursor-pointer",i&&"opacity-50"),children:i?(0,l.jsx)(f.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(x.Z,{className:"-rotate-45 w-4 h-4"})})]})}let v=n.forwardRef((e,s)=>{let{className:t,type:a,...n}=e;return(0,l.jsx)("input",{type:a,className:m("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});v.displayName="Input";var b=t(71483),j=t(20703);function w(e){let{url:s,onRemove:t}=e;return(0,l.jsxs)("div",{className:"relative w-20 h-20 group",children:[(0,l.jsx)(j.default,{src:s,alt:"Uploaded image",fill:!0,className:"object-cover w-full h-full rounded-xl hover:brightness-75"}),(0,l.jsx)("div",{className:m("absolute -top-2 -right-2 w-6 h-6 z-10 bg-gray-500 text-white rounded-full hidden group-hover:block"),children:(0,l.jsx)(b.Z,{className:"w-6 h-6 bg-gray-500 text-white rounded-full",onClick:t})})]})}function y(e){let[s,t]=(0,n.useState)(null),a=async e=>{t(await new Promise((s,t)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=()=>s(l.result),l.onerror=e=>t(e)}))},r=async s=>{var t,l;try{if(e.multiModal&&s.type.startsWith("image/"))return await a(s);null===(t=e.onFileUpload)||void 0===t||t.call(e,s)}catch(s){console.log("檔案上傳錯誤：".concat(s)),null===(l=e.onFileError)||void 0===l||l.call(e,s.message)}};return(0,l.jsxs)("form",{onSubmit:l=>{if(s){e.handleSubmit(l,{data:{imageUrl:s}}),t(null);return}e.handleSubmit(l)},className:"rounded-xl bg-white p-4 shadow-xl space-y-4",children:[s&&(0,l.jsx)(w,{url:s,onRemove:()=>t(null)}),(0,l.jsxs)("div",{className:"flex w-full items-start justify-between gap-4 ",children:[(0,l.jsx)(v,{autoFocus:!0,name:"message",placeholder:"Type a message",className:"flex-1",value:e.input,onChange:e.handleInputChange}),e.multiModal&&(0,l.jsx)(g,{onFileUpload:r,onFileError:e.onFileError}),(0,l.jsx)(p,{type:"submit",disabled:e.isLoading,children:"Send message"})]})]})}var N=t(10081),k=t(40834);function C(e){return(0,l.jsxs)("div",{className:"space-x-4",children:[e.showStop&&(0,l.jsxs)(p,{variant:"outline",size:"sm",onClick:e.stop,children:[(0,l.jsx)(N.Z,{className:"mr-2 h-4 w-4"}),"Stop generating"]}),e.showReload&&(0,l.jsxs)(p,{variant:"outline",size:"sm",onClick:e.reload,children:[(0,l.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"Regenerate"]})]})}var L=t(80037),z=t(23416),R=t(52835);function S(e){let{role:s}=e;return"user"===s?(0,l.jsx)("div",{className:"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border bg-background shadow",children:(0,l.jsx)(R.Z,{className:"h-4 w-4"})}):(0,l.jsx)("div",{className:"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border bg-black text-white shadow",children:(0,l.jsx)(j.default,{className:"rounded-md",src:"/llama.png",alt:"Llama Logo",width:24,height:24,priority:!0})})}var E=t(49200),Z=t(24130),T=t(28105),F=t(44715),U=t(193),P=t(75688);function _(e){let{timeout:s=2e3}=e,[t,l]=n.useState(!1);return{isCopied:t,copyToClipboard:e=>{var t;(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)&&e&&navigator.clipboard.writeText(e).then(()=>{l(!0),setTimeout(()=>{l(!1)},s)})}}}let I=U.Z,M={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},B=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="ABCDEFGHJKLMNPQRSTUVWXY3456789",l="";for(let s=0;s<e;s++)l+=t.charAt(Math.floor(Math.random()*t.length));return s?l.toLowerCase():l},A=(0,n.memo)(e=>{let{language:s,value:t}=e,{isCopied:a,copyToClipboard:n}=_({timeout:2e3});return(0,l.jsxs)("div",{className:"codeblock relative w-full bg-zinc-950 font-sans",children:[(0,l.jsxs)("div",{className:"flex w-full items-center justify-between bg-zinc-800 px-6 py-2 pr-4 text-zinc-100",children:[(0,l.jsx)("span",{className:"text-xs lowercase",children:s}),(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsxs)(p,{variant:"ghost",onClick:()=>{let e=M[s]||".file",l="file-".concat(B(3,!0)).concat(e),a=window.prompt("Enter file name",l);if(!a)return;let n=new Blob([t],{type:"text/plain"}),r=URL.createObjectURL(n),i=document.createElement("a");i.download=a,i.href=r,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},size:"icon",children:[(0,l.jsx)(F.Z,{}),(0,l.jsx)("span",{className:"sr-only",children:"Download"})]}),(0,l.jsxs)(p,{variant:"ghost",size:"icon",onClick:()=>{a||n(t)},children:[a?(0,l.jsx)(L.Z,{className:"h-4 w-4"}):(0,l.jsx)(z.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{className:"sr-only",children:"Copy code"})]})]})]}),(0,l.jsx)(I,{language:s,style:P.RY,PreTag:"div",showLineNumbers:!0,customStyle:{width:"100%",background:"transparent",padding:"1.5rem 1rem",borderRadius:"0.5rem"},codeTagProps:{style:{fontSize:"0.9rem",fontFamily:"var(--font-mono)"}},children:t})]})});A.displayName="CodeBlock";let D=(0,n.memo)(E.D,(e,s)=>e.children===s.children&&e.className===s.className);function O(e){let{content:s}=e;return(0,l.jsx)(D,{className:"prose dark:prose-invert prose-p:leading-relaxed prose-pre:p-0 break-words",remarkPlugins:[Z.Z,T.Z],components:{p(e){let{children:s}=e;return(0,l.jsx)("p",{className:"mb-2 last:mb-0",children:s})},code(e){let{node:s,inline:t,className:a,children:n,...r}=e;if(n.length){if("▍"==n[0])return(0,l.jsx)("span",{className:"mt-1 animate-pulse cursor-default",children:"▍"});n[0]=n[0].replace("`▍`","▍")}let i=/language-(\w+)/.exec(a||"");return t?(0,l.jsx)("code",{className:a,...r,children:n}):(0,l.jsx)(A,{language:i&&i[1]||"",value:String(n).replace(/\n$/,""),...r},Math.random())}},children:s})}function H(e){let{messageData:s}=e,{image_url:t,type:a}=s;return"image_url"===a?(0,l.jsx)("div",{className:"rounded-md max-w-[200px] shadow-md",children:(0,l.jsx)(j.default,{src:t.url,width:0,height:0,sizes:"100vw",style:{width:"100%",height:"auto"},alt:""})}):null}function W(e){let{isCopied:s,copyToClipboard:t}=_({timeout:2e3});return(0,l.jsxs)("div",{className:"flex items-start gap-4 pr-5 pt-5",children:[(0,l.jsx)(S,{role:e.role}),(0,l.jsxs)("div",{className:"group flex flex-1 justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex-1 space-y-4",children:[e.data&&(0,l.jsx)(H,{messageData:e.data}),(0,l.jsx)(O,{content:e.content})]}),(0,l.jsx)(p,{onClick:()=>t(e.content),size:"icon",variant:"ghost",className:"h-8 w-8 opacity-0 group-hover:opacity-100",children:s?(0,l.jsx)(L.Z,{className:"h-4 w-4"}):(0,l.jsx)(z.Z,{className:"h-4 w-4"})})]})]})}function q(e){let s=(0,n.useRef)(null),t=e.messages.length,a=e.messages[t-1],r=()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},i=t>0&&(null==a?void 0:a.role)!=="user",o=e.reload&&!e.isLoading&&i,c=e.stop&&e.isLoading,d=e.isLoading&&!i;return(0,n.useEffect)(()=>{r()},[t,a]),(0,l.jsxs)("div",{className:"w-full rounded-xl bg-white p-4 shadow-xl pb-0",children:[(0,l.jsxs)("div",{className:"flex h-[50vh] flex-col gap-5 divide-y overflow-y-auto pb-4",ref:s,children:[e.messages.map(e=>(0,l.jsx)(W,{...e},e.id)),d&&(0,l.jsx)("div",{className:"flex justify-center items-center pt-10",children:(0,l.jsx)(f.Z,{className:"h-4 w-4 animate-spin"})})]}),(0,l.jsx)("div",{className:"flex justify-end py-4",children:(0,l.jsx)(C,{reload:e.reload,stop:e.stop,showReload:o,showStop:c})})]})}var J=t(32215);function V(){let{messages:e,input:s,isLoading:t,handleSubmit:r,handleInputChange:o,reload:c,stop:d,data:u}=(0,a.RJ)({api:J.env.NEXT_PUBLIC_CHAT_API,headers:{"Content-Type":"application/json"}}),m=(0,n.useMemo)(()=>i(e,u),[e,u]);return(0,l.jsxs)("div",{className:"space-y-4 max-w-5xl w-full",children:[(0,l.jsx)(q,{messages:m,isLoading:t,reload:c,stop:d}),(0,l.jsx)(y,{input:s,handleSubmit:r,handleInputChange:o,isLoading:t,multiModal:!1})]})}}},function(e){e.O(0,[77,971,69,744],function(){return e(e.s=46482)}),_N_E=e.O()}]);